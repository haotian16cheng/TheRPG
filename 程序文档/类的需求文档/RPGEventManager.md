# 事件系统

## 概述

rpg游戏中的事件系统，不是指程序中鼠标键盘等事件。是指比如显示对话框，跳转场景这一类事件

## 指令

带*号的是目前要实现的，格式为{"code":x(int),"indent":x(int),"parameters":[](vector)},code指指令对应的事件id，intent表示层级同时也能表示属于哪一个指令，paramenters，则是参数。

- 文字类
  - 显示对话框* showtxt
    code:101，显示对话，角色和表情决定显示的头像，内容决定显示的话
    - 参数1【角色】string
    - 参数2【表情】int
    - 参数3【内容】string

  - 显示选择项* showsel
    code:102，根据选择项的数组生成选择项，比如[是，否，好]显示三个选择项
    [是，否]显示两个选择项，根据选择内容进行分支
    - 参数1【选择项】vector<string>，一个string的数组，最大为4个

  - 选择* case
    - code:103,
    - 参数1【id】int，选择的选项的id
    - 参数2【name】string，选贼的选项的名字

  - 结束

  - 输入数字 showent

  - 显示系统消息 showwin

  - 滚动字幕 showbgt

- 流程类

  - 等待* wait
    code:201
    - 参数1【时间】int，等待几帧

  - 空事件* null
    code:202，无参数

  - 设置开关* setswi
    code:203，将minid-maxid的所有开关设置属性开或者关
    - 参数1【minid】int，要设置的开关开始的id
    - 参数2【maxid】int，要设置的开关结束的id
    - 参数3【0或1】int，设置的开关是开还是管

  - 设置变量* setvar
    code:204,将minid-maxid的所有变量的值改变
    - 参数1【minid】int
    - 参数2【maxid】int
    - 参数3【改变方式】int，1-6对应‘赋值’，‘加’，‘减’，‘乘’，‘除’，‘取模’
    - 参数4【改变类型】int，0-2对应‘常量’，‘变量’，‘随机数’
      - 情况1
        - 参数5【常量的值】int
      - 情况2
        - 参数5【变量的id】int
      - 情况3
        - 参数5【随机数的下限】int
        - 参数6【随机数的上限】int

  - 设置计时器 settim
  
- 控制类

  - 分支选择（if）
    code:301
    - 参数1【type】int，分支选择的type，后面的参数个数根据type不同的改变
      - 情况1，索引为id的开关的属性是否匹配
        - 参数2【开关id】int，开关的id
        - 参数3【开关的属性】int,0或1
      - 情况2
        - 参数2【变量的id】int
        - 参数3【是否和另一个变量比较】int，0为和常量比较，1为和另一个变量比较
        - 参数4【比较方式】int，1-6对应'=','>','<','>=',"<=","!="
        - 参数5【常量的值】int，当和变量比较的时候忽略

  - 分支选择（else）
    code:302，不满足if的情况，无参数

  - 结束（end）
    - code:303,表示if，switch，和for等的结束标志，无参数

- 移动
  - 普通移动

  - 直接移动*
    code:302，移动到id对应的场景
    - 参数1【id】int，移动到的场景的id
    - 参数2【效果类型】int，改变场景的时候，选择黑色白色淡入淡出等

  - 传送

- 场景控制
  - 战斗处理
  - 商店处理
  - 游戏结束

- 数据
  - 更改道具
  - 更改金钱




